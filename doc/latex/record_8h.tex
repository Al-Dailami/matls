\hypertarget{record_8h}{\section{record/record.h File Reference}
\label{record_8h}\index{record/record.\-h@{record/record.\-h}}
}
{\ttfamily \#include $<$stdio.\-h$>$}\\*
{\ttfamily \#include $<$string.\-h$>$}\\*
{\ttfamily \#include $<$errno.\-h$>$}\\*
{\ttfamily \#include $<$unistd.\-h$>$}\\*
{\ttfamily \#include $<$openssl/ssl.\-h$>$}\\*
{\ttfamily \#include $<$openssl/err.\-h$>$}\\*
{\ttfamily \#include $<$sys/time.\-h$>$}\\*
{\ttfamily \#include $<$sys/socket.\-h$>$}\\*
{\ttfamily \#include $<$sys/queue.\-h$>$}\\*
{\ttfamily \#include \char`\"{}prf.\-h\char`\"{}}\\*
Include dependency graph for record.\-h\-:
This graph shows which files directly or indirectly include this file\-:
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structentry}{entry}
\begin{DoxyCompactList}\small\item\em Data structure for global M\-A\-C. \end{DoxyCompactList}\item 
struct \hyperlink{structmodification__record}{modification\-\_\-record}
\begin{DoxyCompactList}\small\item\em Data structure for the modification record. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \hyperlink{structentry}{entry} \hyperlink{record_8h_a94ecbe0a4e9d60f85353494c4c4a849a}{M\-R\-\_\-\-E\-N\-T\-R\-Y}
\begin{DoxyCompactList}\small\item\em Data structure for global M\-A\-C. \end{DoxyCompactList}\item 
typedef struct \hyperlink{structmodification__record}{modification\-\_\-record} \hyperlink{record_8h_a9e2e75eff1397e3a7be9a5da10e07c7b}{M\-O\-D\-\_\-\-R\-E\-C\-O\-R\-D}
\begin{DoxyCompactList}\small\item\em Data structure for the modification record. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{record_8h_a43c42ddc99d5462b78d93c9233acef0f}{init\-\_\-record} (\hyperlink{record_8h_a9e2e75eff1397e3a7be9a5da10e07c7b}{M\-O\-D\-\_\-\-R\-E\-C\-O\-R\-D} $\ast$$\ast$mr, int len)
\begin{DoxyCompactList}\small\item\em Initialize the modification record. \end{DoxyCompactList}\item 
int \hyperlink{record_8h_a0c6a69afb5dc0c06d3ff6da84b483a9d}{free\-\_\-record} (\hyperlink{record_8h_a9e2e75eff1397e3a7be9a5da10e07c7b}{M\-O\-D\-\_\-\-R\-E\-C\-O\-R\-D} $\ast$mr)
\begin{DoxyCompactList}\small\item\em Destruct the modification record. \end{DoxyCompactList}\item 
int \hyperlink{record_8h_a4e93c3ea71dcfc0db5df86a5ed6fa8f3}{init\-\_\-entry} (\hyperlink{record_8h_a94ecbe0a4e9d60f85353494c4c4a849a}{M\-R\-\_\-\-E\-N\-T\-R\-Y} $\ast$$\ast$\hyperlink{structentry}{entry}, int len)
\begin{DoxyCompactList}\small\item\em Initialize the entry in the modification record. \end{DoxyCompactList}\item 
int \hyperlink{record_8h_ae72ebed91e5322bf67e269f23a07838a}{free\-\_\-entry} (\hyperlink{record_8h_a94ecbe0a4e9d60f85353494c4c4a849a}{M\-R\-\_\-\-E\-N\-T\-R\-Y} $\ast$\hyperlink{structentry}{entry})
\begin{DoxyCompactList}\small\item\em Free the entry. \end{DoxyCompactList}\item 
int \hyperlink{record_8h_a3d5bd635369e2190ee204e370458b577}{add\-\_\-source\-\_\-mac} (\hyperlink{prf_8h_a2e4c9fad15fd913a2f3bc5557701fdc2}{S\-E\-C\-U\-R\-I\-T\-Y\-\_\-\-P\-A\-R\-A\-M\-S} $\ast$sp, \hyperlink{record_8h_a9e2e75eff1397e3a7be9a5da10e07c7b}{M\-O\-D\-\_\-\-R\-E\-C\-O\-R\-D} $\ast$mr, unsigned char $\ast$msg, int mlen, unsigned char $\ast$key, int klen)
\begin{DoxyCompactList}\small\item\em Add the source's M\-A\-C. \end{DoxyCompactList}\item 
int \hyperlink{record_8h_a42fdfb5f9950f4a8a287b83099c62bf6}{add\-\_\-global\-\_\-mac} (\hyperlink{prf_8h_a2e4c9fad15fd913a2f3bc5557701fdc2}{S\-E\-C\-U\-R\-I\-T\-Y\-\_\-\-P\-A\-R\-A\-M\-S} $\ast$sp, \hyperlink{record_8h_a9e2e75eff1397e3a7be9a5da10e07c7b}{M\-O\-D\-\_\-\-R\-E\-C\-O\-R\-D} $\ast$mr, unsigned char $\ast$id, int idlen, unsigned char $\ast$key, int klen, unsigned char $\ast$prev, int plen, unsigned char $\ast$next, int nlen)
\begin{DoxyCompactList}\small\item\em Add the global M\-A\-C. \end{DoxyCompactList}\item 
int \hyperlink{record_8h_a00dc42186825f0081101d2a702010e66}{verify\-\_\-record} ()
\item 
int \hyperlink{record_8h_a3ac7c0fbf18bf74b8e90b852c71dc7ac}{print\-\_\-record} (\hyperlink{record_8h_a9e2e75eff1397e3a7be9a5da10e07c7b}{M\-O\-D\-\_\-\-R\-E\-C\-O\-R\-D} $\ast$mr)
\begin{DoxyCompactList}\small\item\em Print the modification record. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Typedef Documentation}
\hypertarget{record_8h_a9e2e75eff1397e3a7be9a5da10e07c7b}{\index{record.\-h@{record.\-h}!M\-O\-D\-\_\-\-R\-E\-C\-O\-R\-D@{M\-O\-D\-\_\-\-R\-E\-C\-O\-R\-D}}
\index{M\-O\-D\-\_\-\-R\-E\-C\-O\-R\-D@{M\-O\-D\-\_\-\-R\-E\-C\-O\-R\-D}!record.h@{record.\-h}}
\subsubsection[{M\-O\-D\-\_\-\-R\-E\-C\-O\-R\-D}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf modification\-\_\-record}  {\bf M\-O\-D\-\_\-\-R\-E\-C\-O\-R\-D}}}\label{record_8h_a9e2e75eff1397e3a7be9a5da10e07c7b}


Data structure for the modification record. 

\hypertarget{record_8h_a94ecbe0a4e9d60f85353494c4c4a849a}{\index{record.\-h@{record.\-h}!M\-R\-\_\-\-E\-N\-T\-R\-Y@{M\-R\-\_\-\-E\-N\-T\-R\-Y}}
\index{M\-R\-\_\-\-E\-N\-T\-R\-Y@{M\-R\-\_\-\-E\-N\-T\-R\-Y}!record.h@{record.\-h}}
\subsubsection[{M\-R\-\_\-\-E\-N\-T\-R\-Y}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf entry}  {\bf M\-R\-\_\-\-E\-N\-T\-R\-Y}}}\label{record_8h_a94ecbe0a4e9d60f85353494c4c4a849a}


Data structure for global M\-A\-C. 



\subsection{Function Documentation}
\hypertarget{record_8h_a42fdfb5f9950f4a8a287b83099c62bf6}{\index{record.\-h@{record.\-h}!add\-\_\-global\-\_\-mac@{add\-\_\-global\-\_\-mac}}
\index{add\-\_\-global\-\_\-mac@{add\-\_\-global\-\_\-mac}!record.h@{record.\-h}}
\subsubsection[{add\-\_\-global\-\_\-mac}]{\setlength{\rightskip}{0pt plus 5cm}int add\-\_\-global\-\_\-mac (
\begin{DoxyParamCaption}
\item[{{\bf S\-E\-C\-U\-R\-I\-T\-Y\-\_\-\-P\-A\-R\-A\-M\-S} $\ast$}]{sp, }
\item[{{\bf M\-O\-D\-\_\-\-R\-E\-C\-O\-R\-D} $\ast$}]{mr, }
\item[{unsigned char $\ast$}]{id, }
\item[{int}]{idlen, }
\item[{unsigned char $\ast$}]{key, }
\item[{int}]{klen, }
\item[{unsigned char $\ast$}]{prev, }
\item[{int}]{plen, }
\item[{unsigned char $\ast$}]{next, }
\item[{int}]{nlen}
\end{DoxyParamCaption}
)}}\label{record_8h_a42fdfb5f9950f4a8a287b83099c62bf6}


Add the global M\-A\-C. 


\begin{DoxyParams}{Parameters}
{\em sp} & Security Parameters \\
\hline
{\em mr} & Modification Record \\
\hline
{\em id} & I\-D of the writer \\
\hline
{\em idlen} & Length of I\-D \\
\hline
{\em key} & M\-A\-C key \\
\hline
{\em klen} & Length of Key \\
\hline
{\em prev} & Previous Message \\
\hline
{\em plen} & Length of Previous Message \\
\hline
{\em next} & Next Message \\
\hline
{\em nlen} & Length of Next Message \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{errors_8h_aa90cac659d18e8ef6294c7ae337f6b58}{S\-U\-C\-C\-E\-S\-S(0)}/\-F\-A\-I\-L\-U\-R\-E(-\/1) 
\end{DoxyReturn}
\hypertarget{record_8h_a3d5bd635369e2190ee204e370458b577}{\index{record.\-h@{record.\-h}!add\-\_\-source\-\_\-mac@{add\-\_\-source\-\_\-mac}}
\index{add\-\_\-source\-\_\-mac@{add\-\_\-source\-\_\-mac}!record.h@{record.\-h}}
\subsubsection[{add\-\_\-source\-\_\-mac}]{\setlength{\rightskip}{0pt plus 5cm}int add\-\_\-source\-\_\-mac (
\begin{DoxyParamCaption}
\item[{{\bf S\-E\-C\-U\-R\-I\-T\-Y\-\_\-\-P\-A\-R\-A\-M\-S} $\ast$}]{sp, }
\item[{{\bf M\-O\-D\-\_\-\-R\-E\-C\-O\-R\-D} $\ast$}]{mr, }
\item[{unsigned char $\ast$}]{msg, }
\item[{int}]{mlen, }
\item[{unsigned char $\ast$}]{key, }
\item[{int}]{klen}
\end{DoxyParamCaption}
)}}\label{record_8h_a3d5bd635369e2190ee204e370458b577}


Add the source's M\-A\-C. 


\begin{DoxyParams}{Parameters}
{\em sp} & Security Parameters \\
\hline
{\em mr} & Modification Record \\
\hline
{\em msg} & Source Message \\
\hline
{\em mlen} & Length of the source message \\
\hline
{\em key} & Secret value \\
\hline
{\em klen} & Length of the key \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{errors_8h_aa90cac659d18e8ef6294c7ae337f6b58}{S\-U\-C\-C\-E\-S\-S(0)}/\-F\-A\-I\-L\-U\-R\-E(-\/1) 
\end{DoxyReturn}
\hypertarget{record_8h_ae72ebed91e5322bf67e269f23a07838a}{\index{record.\-h@{record.\-h}!free\-\_\-entry@{free\-\_\-entry}}
\index{free\-\_\-entry@{free\-\_\-entry}!record.h@{record.\-h}}
\subsubsection[{free\-\_\-entry}]{\setlength{\rightskip}{0pt plus 5cm}int free\-\_\-entry (
\begin{DoxyParamCaption}
\item[{{\bf M\-R\-\_\-\-E\-N\-T\-R\-Y} $\ast$}]{entry}
\end{DoxyParamCaption}
)}}\label{record_8h_ae72ebed91e5322bf67e269f23a07838a}


Free the entry. 


\begin{DoxyParams}{Parameters}
{\em entry} & Entry to be freed \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{errors_8h_aa90cac659d18e8ef6294c7ae337f6b58}{S\-U\-C\-C\-E\-S\-S(0)}/\-F\-A\-I\-L\-U\-R\-E(-\/1) 
\end{DoxyReturn}
\hypertarget{record_8h_a0c6a69afb5dc0c06d3ff6da84b483a9d}{\index{record.\-h@{record.\-h}!free\-\_\-record@{free\-\_\-record}}
\index{free\-\_\-record@{free\-\_\-record}!record.h@{record.\-h}}
\subsubsection[{free\-\_\-record}]{\setlength{\rightskip}{0pt plus 5cm}int free\-\_\-record (
\begin{DoxyParamCaption}
\item[{{\bf M\-O\-D\-\_\-\-R\-E\-C\-O\-R\-D} $\ast$}]{mr}
\end{DoxyParamCaption}
)}}\label{record_8h_a0c6a69afb5dc0c06d3ff6da84b483a9d}


Destruct the modification record. 

Destruct the modification record


\begin{DoxyParams}{Parameters}
{\em mr} & Data structure of the modification record \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{errors_8h_aa90cac659d18e8ef6294c7ae337f6b58}{S\-U\-C\-C\-E\-S\-S(1)}/\-F\-A\-I\-L\-U\-R\-E(0) 
\end{DoxyReturn}
\hypertarget{record_8h_a4e93c3ea71dcfc0db5df86a5ed6fa8f3}{\index{record.\-h@{record.\-h}!init\-\_\-entry@{init\-\_\-entry}}
\index{init\-\_\-entry@{init\-\_\-entry}!record.h@{record.\-h}}
\subsubsection[{init\-\_\-entry}]{\setlength{\rightskip}{0pt plus 5cm}int init\-\_\-entry (
\begin{DoxyParamCaption}
\item[{{\bf M\-R\-\_\-\-E\-N\-T\-R\-Y} $\ast$$\ast$}]{entry, }
\item[{int}]{len}
\end{DoxyParamCaption}
)}}\label{record_8h_a4e93c3ea71dcfc0db5df86a5ed6fa8f3}


Initialize the entry in the modification record. 


\begin{DoxyParams}{Parameters}
{\em entry} & Entry to be initialized \\
\hline
{\em len} & Length of M\-A\-C \\
\hline
\end{DoxyParams}
\hypertarget{record_8h_a43c42ddc99d5462b78d93c9233acef0f}{\index{record.\-h@{record.\-h}!init\-\_\-record@{init\-\_\-record}}
\index{init\-\_\-record@{init\-\_\-record}!record.h@{record.\-h}}
\subsubsection[{init\-\_\-record}]{\setlength{\rightskip}{0pt plus 5cm}int init\-\_\-record (
\begin{DoxyParamCaption}
\item[{{\bf M\-O\-D\-\_\-\-R\-E\-C\-O\-R\-D} $\ast$$\ast$}]{mr, }
\item[{int}]{len}
\end{DoxyParamCaption}
)}}\label{record_8h_a43c42ddc99d5462b78d93c9233acef0f}


Initialize the modification record. 

Initialize the modification record


\begin{DoxyParams}{Parameters}
{\em mr} & Data structure of the modification record \\
\hline
{\em len} & Length of the M\-A\-C \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{errors_8h_aa90cac659d18e8ef6294c7ae337f6b58}{S\-U\-C\-C\-E\-S\-S(1)}/\-F\-A\-I\-L\-U\-R\-E(0) 
\end{DoxyReturn}
\hypertarget{record_8h_a3ac7c0fbf18bf74b8e90b852c71dc7ac}{\index{record.\-h@{record.\-h}!print\-\_\-record@{print\-\_\-record}}
\index{print\-\_\-record@{print\-\_\-record}!record.h@{record.\-h}}
\subsubsection[{print\-\_\-record}]{\setlength{\rightskip}{0pt plus 5cm}int print\-\_\-record (
\begin{DoxyParamCaption}
\item[{{\bf M\-O\-D\-\_\-\-R\-E\-C\-O\-R\-D} $\ast$}]{mr}
\end{DoxyParamCaption}
)}}\label{record_8h_a3ac7c0fbf18bf74b8e90b852c71dc7ac}


Print the modification record. 

\hypertarget{record_8h_a00dc42186825f0081101d2a702010e66}{\index{record.\-h@{record.\-h}!verify\-\_\-record@{verify\-\_\-record}}
\index{verify\-\_\-record@{verify\-\_\-record}!record.h@{record.\-h}}
\subsubsection[{verify\-\_\-record}]{\setlength{\rightskip}{0pt plus 5cm}int verify\-\_\-record (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{record_8h_a00dc42186825f0081101d2a702010e66}
